types:
  # Rename generic "Type" enum to "FieldType" to avoid conflicts with Go keyword shadow.
  Type:
    name: FieldType
    doc: "FieldType represents the Elasticsearch mapping type of a field."

  Field:
    doc: "Field represents a field definition in a data stream's field mapping."
    extra_fields:
      - name: JsonPointer
        type: string
        doc: "JsonPointer is the RFC 6901 JSON Pointer to this field's location in the original fields file (e.g. /0/fields/1). Set by pkgreader after parsing."
        json: "json_pointer,omitempty"
        yaml: "-"
    fields:
      example:
        type: any
      null_value:
        type: any
      dynamic:
        type: any
        doc: "Dynamic controls whether new fields are added dynamically. Accepts true, false, \"strict\", or \"runtime\"."
      runtime:
        type: any
        doc: "Runtime specifies if this field is evaluated at query time. Can be a boolean or a script string."
      default_metric:
        type: any
      metrics:
        type: any

  Var:
    doc: "Var represents an input variable definition for a package."
    embed_meta: true
    fields:
      default:
        type: any
        doc: "Default is the default value for the variable."
      options:
        type: any
        doc: "Options provides the list of selectable options when type is \"select\"."

  ElasticsearchIndexTemplateMappings:
    name: IndexTemplateMappings
    fields:
      dynamic:
        type: any
        doc: "Dynamic controls whether new fields can be added dynamically to the mapping."
      dynamic_templates:
        type: any
        doc: "DynamicTemplates defines custom rules for dynamic field mapping."

  IndexTemplateSettingIndexSort:
    name: IndexSort
    fields:
      field:
        type: any
        doc: "Field is the field or fields used to sort documents."
      order:
        type: any
        doc: "Order is the sort order to use for each field."

  TransformSource:
    fields:
      index:
        type: any
        doc: "Index is the source index or indices for the transform."
      query:
        type: any
        doc: "Query filters the source documents."
      runtime_mappings:
        type: any
        doc: "RuntimeMappings defines runtime fields for the source."

  TransformPivot:
    fields:
      aggregations:
        type: any
        doc: "Aggregations defines the aggregations for the pivot."
      aggs:
        type: any
        doc: "Aggs is an alias for Aggregations."
      group_by:
        type: any
        doc: "GroupBy defines the grouping for the pivot."

  Transform:
    doc: "Transform represents an Elasticsearch transform definition."
    fields:
      _meta:
        name: Meta
        type: "map[string]any"
        doc: "Meta holds user-defined metadata about the transform."

  IngestPipeline:
    doc: "IngestPipeline represents an Elasticsearch ingest pipeline definition."
    fields:
      processors:
        type: "[]*Processor"
      on_failure:
        type: "[]*Processor"

  IntegrationManifestPolicyTemplateInput:
    name: PolicyTemplateInput
    fields:
      hide_in_var_group_options:
        type: "map[string][]string"
        doc: "HideInVarGroupOptions filters out specific var_group options for this input."

  # RequiredVars uses patternProperties and needs a map type.
  RequiredVars:
    name: RequiredVars

  # The routing rules schema has a name collision: the top-level array items
  # object and the #/definitions/routing_rule both singularize to "RoutingRule".
  # The generator produces RoutingRule (outer set) and RoutingRule2 (inner rule).
  RoutingRule:
    name: RoutingRuleSet
    doc: "RoutingRuleSet represents a set of routing rules for rerouting documents from a source dataset. Routing rules are a technical preview feature."

  RoutingRule2:
    name: RoutingRule
    doc: "RoutingRule defines a single routing rule within a RoutingRuleSet (technical preview)."
    embed_meta: true
    fields:
      target_dataset:
        type: StringOrStrings
        doc: "TargetDataset is the field reference or static value for the dataset part of the data stream name."
      namespace:
        type: StringOrStrings
        doc: "Namespace is the field reference or static value for the namespace part of the data stream name."

  Changelog:
    extra_fields:
      - name: Date
        type: "*time.Time"
        doc: "Date is the approximate release date, populated via git blame when WithGitMetadata is used."
        json: "date,omitempty"
        yaml: "-"

  DataStreamManifest:
    extra_fields:
      - name: GithubOwner
        type: string
        doc: "GithubOwner is the GitHub team owner from CODEOWNERS, populated when WithCodeowners is used."
        json: "github_owner,omitempty"
        yaml: "-"

  BuildManifestDependenciesECS:
    name: BuildDependenciesECS
    fields:
      reference:
        doc: "Reference is the ECS version source reference. Values begin with \"git@\" (e.g. \"git@v8.11.0\")."

  # Task 0: ManifestType coalescing â€” override the type field on all three manifests
  # to use the hand-written ManifestType instead of the generated single-value enums.
  IntegrationManifest:
    fields:
      type:
        type: ManifestType

  InputManifest:
    fields:
      type:
        type: ManifestType

  ContentManifest:
    fields:
      type:
        type: ManifestType

  # Test config type renames to avoid generic names.
  Skip:
    name: TestSkip
    doc: "TestSkip describes why a test should be skipped, with a reason and tracking link."

  Vars:
    name: TestVars
    doc: "TestVars holds variables defined for a test case."

  ConfigTests:
    name: TestCategoryConfig
    doc: "TestCategoryConfig controls parallelism and skip for a test category."

  TestConfig:
    doc: "TestConfig holds the package-level test configuration for integration packages (_dev/test/config.yml)."

  InputTestConfig:
    doc: "InputTestConfig holds the package-level test configuration for input packages (_dev/test/config.yml)."

  PipelineTestCommonConfig:
    doc: "PipelineTestCommonConfig holds shared configuration for all pipeline tests in a data stream (test-common-config.yml)."
    fields:
      numeric_keyword_fields:
        type: "[]string"
        doc: "NumericKeywordFields lists keyword type fields allowed to have a numeric value."
      string_number_fields:
        type: "[]string"
        doc: "StringNumberFields lists numeric type fields allowed to have a string value if parseable as a number."

  PipelineTestJSONConfig:
    doc: "PipelineTestJSONConfig holds per-case configuration for a JSON pipeline test (test-*.json-config.yml)."
    fields:
      numeric_keyword_fields:
        type: "[]string"
        doc: "NumericKeywordFields lists keyword type fields allowed to have a numeric value."
      string_number_fields:
        type: "[]string"
        doc: "StringNumberFields lists numeric type fields allowed to have a string value if parseable as a number."

  PipelineTestRawConfig:
    doc: "PipelineTestRawConfig holds per-case configuration for a raw/log pipeline test (test-*.log-config.yml)."
    fields:
      numeric_keyword_fields:
        type: "[]string"
        doc: "NumericKeywordFields lists keyword type fields allowed to have a numeric value."
      string_number_fields:
        type: "[]string"
        doc: "StringNumberFields lists numeric type fields allowed to have a string value if parseable as a number."

  PipelineTestEvent:
    doc: "PipelineTestEvent holds the input events for a JSON pipeline test (test-*.json)."

  PipelineTestExpected:
    doc: "PipelineTestExpected holds the expected output for a pipeline test (test-*-expected.json)."

  PolicyTestConfig:
    doc: "PolicyTestConfig holds configuration for a policy test case (test-*.yml)."

  StaticTestConfig:
    doc: "StaticTestConfig holds configuration for a static test case (test-*-config.yml)."

  SystemTestConfig:
    doc: "SystemTestConfig holds configuration for a system test case (test-*-config.yml)."

  # --- Tier 1: Egregiously long names ---

  TransformManifestDestinationIndexTemplate:
    name: TransformDestIndexTemplate

  TransformManifestDestinationIndexTemplateSettings:
    name: TransformDestIndexTemplateSettings

  TransformManifestDestinationIndexTemplateSettingsIndex:
    name: TransformDestIndexSettings

  TransformManifestDestinationIndexTemplateSettingsIndexMode:
    name: TransformDestIndexMode

  ElasticsearchIndexTemplateMappingsDynamicTemplateValue:
    name: DynamicTemplateValue

  ElasticsearchIndexTemplateMappingsDynamicTemplateValueMapping:
    name: DynamicTemplateMapping

  IntegrationManifestPolicyTemplateInputDeploymentMode:
    name: PolicyTemplateInputDeploymentMode

  IntegrationManifestPolicyTemplateInputInputGroup:
    name: PolicyTemplateInputGroup

  IndexTemplateSettingAnalysisAnalyzerValueType:
    name: IndexAnalyzerType

  IndexTemplateSettingAnalysisAnalyzerValue:
    name: IndexAnalyzer

  IndexTemplateSettingAnalysis:
    name: IndexAnalysis

  SystemTestConfigAgentPreStartScriptLanguage:
    name: AgentPreStartScriptLanguage

  SystemTestConfigAgentProvisioningScript:
    name: AgentProvisioningScript

  SystemTestConfigAgentPreStartScript:
    name: AgentPreStartScript

  # --- Tier 2: Drop redundant "Manifest" from nested types ---

  DataStreamManifestElasticsearch:
    name: DataStreamElasticsearch

  DataStreamManifestElasticsearchPrivileges:
    name: DataStreamElasticsearchPrivileges

  DataStreamManifestElasticsearchSourceMode:
    name: DataStreamSourceMode

  DataStreamManifestRelease:
    name: DataStreamRelease

  DataStreamManifestStream:
    name: DataStreamStream
    embed_meta: true

  DataStreamManifestType:
    name: DataStreamType

  IntegrationManifestElasticsearch:
    name: IntegrationElasticsearch

  IntegrationManifestElasticsearchPrivileges:
    name: IntegrationElasticsearchPrivileges

  InputManifestElasticsearch:
    name: InputElasticsearch

  BuildManifestDependencies:
    name: BuildDependencies

  IntegrationManifestPolicyTemplate:
    name: PolicyTemplate
    embed_meta: true

  InputManifestPolicyTemplate:
    name: InputPolicyTemplate

  InputManifestPolicyTemplateType:
    name: InputPolicyTemplateType

  SystemTestConfigAgent:
    name: SystemTestAgent

  SystemTestConfigAgentBaseImage:
    name: SystemTestAgentBaseImage

  SystemTestConfigAgentLinuxCapability:
    name: SystemTestAgentLinuxCapability

  SystemTestConfigAgentPIDMode:
    name: SystemTestAgentPIDMode

  SystemTestConfigAgentRuntime:
    name: SystemTestAgentRuntime

  SystemTestConfigDataStream:
    name: SystemTestDataStream

  PolicyTestConfigDataStream:
    name: PolicyTestDataStream

  # --- Tier 3: Elasticsearch/IndexTemplate prefix simplification ---

  ElasticsearchIndexMode:
    name: IndexMode

  ElasticsearchIndexTemplate:
    name: IndexTemplate

  ElasticsearchIndexTemplateDataStream:
    name: IndexTemplateDataStream

  ElasticsearchIndexTemplateIngestPipeline:
    name: IndexTemplatePipeline

  ElasticsearchIndexTemplateSettings:
    name: IndexTemplateSettings

  IndexTemplateSettingIndex:
    name: IndexSettings

  IndexTemplateSettingIndexCodec:
    name: IndexCodec

  IndexTemplateSettingIndexMapping:
    name: IndexMappingConfig

  # --- Tier 4: Minor clarity improvements ---

  ChangelogChange:
    name: ChangelogEntry
    embed_meta: true

  ChangelogChangeType:
    name: ChangelogEntryType

  DeploymentModesAgentlessResources:
    name: AgentlessResources

  DeploymentModesAgentlessResourcesRequests:
    name: AgentlessResourceRequests

  ValidationDocsStructureEnforced:
    name: ValidationDocsStructure

  ValidationDocsStructureEnforcedSkip:
    name: ValidationDocsStructureSkip

  ContentManifestConditions:
    name: ContentConditions

base_types:
  Manifest:
    doc: "Manifest contains the common fields shared by all package manifest types."
    embed_meta: true
    output_file: manifest.go
    sources:
      - IntegrationManifest
      - InputManifest
      - ContentManifest
    fields:
      - categories
      - deprecated
      - description
      - format_version
      - icons
      - name
      - owner
      - screenshots
      - source
      - title
      - type
      - version

  PipelineTestConfig:
    doc: "PipelineTestConfig contains the common fields shared by all pipeline test configuration types."
    embed_meta: true
    output_file: test.go
    sources:
      - PipelineTestCommonConfig
      - PipelineTestJSONConfig
      - PipelineTestRawConfig
    fields:
      - dynamic_fields
      - fields
      - numeric_keyword_fields
      - skip
      - string_number_fields
