// Code generated by cmd/generate; DO NOT EDIT.

package pkgspec

import yamlv3 "gopkg.in/yaml.v3"

// InputTestConfig holds the package-level test configuration for input packages
// (_dev/test/config.yml).
type InputTestConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// Policy configuration for policy tests
	Policy TestCategoryConfig `json:"policy,omitempty" yaml:"policy,omitempty"`
	// System configuration for system tests
	System TestCategoryConfig `json:"system,omitempty" yaml:"system,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for InputTestConfig.
// It captures the YAML node position for FileMetadata.
func (v *InputTestConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainInputTestConfig InputTestConfig
	x := (*plainInputTestConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PipelineTestCommonConfig holds shared configuration for all pipeline tests in a data stream
// (test-common-config.yml).
type PipelineTestCommonConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// DynamicFields dynamic fields with regular expressions defining their variable values.
	DynamicFields map[string]any `json:"dynamic_fields,omitempty" yaml:"dynamic_fields,omitempty"`
	// Fields field definitions
	Fields map[string]any `json:"fields,omitempty" yaml:"fields,omitempty"`
	// Multiline multi-line configuration
	Multiline map[string]any `json:"multiline,omitempty" yaml:"multiline,omitempty"`
	// NumericKeywordFields lists keyword type fields allowed to have a numeric value.
	NumericKeywordFields []string `json:"numeric_keyword_fields,omitempty" yaml:"numeric_keyword_fields,omitempty"`
	Skip                 TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
	// StringNumberFields lists numeric type fields allowed to have a string value if parseable as a
	// number.
	StringNumberFields []string `json:"string_number_fields,omitempty" yaml:"string_number_fields,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PipelineTestCommonConfig.
// It captures the YAML node position for FileMetadata.
func (v *PipelineTestCommonConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPipelineTestCommonConfig PipelineTestCommonConfig
	x := (*plainPipelineTestCommonConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PipelineTestEvent holds the input events for a JSON pipeline test (test-*.json).
type PipelineTestEvent struct {
	FileMetadata `json:"-" yaml:"-"`
	// Events given events
	Events []map[string]any `json:"events" yaml:"events"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PipelineTestEvent.
// It captures the YAML node position for FileMetadata.
func (v *PipelineTestEvent) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPipelineTestEvent PipelineTestEvent
	x := (*plainPipelineTestEvent)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PipelineTestExpected holds the expected output for a pipeline test (test-*-expected.json).
type PipelineTestExpected struct {
	FileMetadata `json:"-" yaml:"-"`
	// Expected test result
	Expected []any `json:"expected" yaml:"expected"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PipelineTestExpected.
// It captures the YAML node position for FileMetadata.
func (v *PipelineTestExpected) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPipelineTestExpected PipelineTestExpected
	x := (*plainPipelineTestExpected)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PipelineTestJSONConfig holds per-case configuration for a JSON pipeline test
// (test-*.json-config.yml).
type PipelineTestJSONConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// DynamicFields dynamic fields with regular expressions defining their variable values.
	DynamicFields map[string]any `json:"dynamic_fields,omitempty" yaml:"dynamic_fields,omitempty"`
	// Fields field definitions
	Fields map[string]any `json:"fields,omitempty" yaml:"fields,omitempty"`
	// NumericKeywordFields lists keyword type fields allowed to have a numeric value.
	NumericKeywordFields []string `json:"numeric_keyword_fields,omitempty" yaml:"numeric_keyword_fields,omitempty"`
	Skip                 TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
	// StringNumberFields lists numeric type fields allowed to have a string value if parseable as a
	// number.
	StringNumberFields []string `json:"string_number_fields,omitempty" yaml:"string_number_fields,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PipelineTestJSONConfig.
// It captures the YAML node position for FileMetadata.
func (v *PipelineTestJSONConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPipelineTestJSONConfig PipelineTestJSONConfig
	x := (*plainPipelineTestJSONConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PipelineTestRawConfig holds per-case configuration for a raw/log pipeline test
// (test-*.log-config.yml).
type PipelineTestRawConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// DynamicFields dynamic fields with regular expressions defining their variable values.
	DynamicFields map[string]any `json:"dynamic_fields,omitempty" yaml:"dynamic_fields,omitempty"`
	// Fields field definitions
	Fields map[string]any `json:"fields,omitempty" yaml:"fields,omitempty"`
	// Multiline multi-line configuration
	Multiline map[string]any `json:"multiline,omitempty" yaml:"multiline,omitempty"`
	// NumericKeywordFields lists keyword type fields allowed to have a numeric value.
	NumericKeywordFields []string `json:"numeric_keyword_fields,omitempty" yaml:"numeric_keyword_fields,omitempty"`
	Skip                 TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
	// StringNumberFields lists numeric type fields allowed to have a string value if parseable as a
	// number.
	StringNumberFields []string `json:"string_number_fields,omitempty" yaml:"string_number_fields,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PipelineTestRawConfig.
// It captures the YAML node position for FileMetadata.
func (v *PipelineTestRawConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPipelineTestRawConfig PipelineTestRawConfig
	x := (*plainPipelineTestRawConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// PolicyTestConfig holds configuration for a policy test case (test-*.yml).
type PolicyTestConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// DataStream configuration for the data stream.
	DataStream *PolicyTestConfigDataStream `json:"data_stream,omitempty" yaml:"data_stream,omitempty"`
	// Input the input of the package to test.
	Input string   `json:"input,omitempty" yaml:"input,omitempty"`
	Skip  TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
	// Vars variables used to configure settings defined in the package manifest.
	Vars TestVars `json:"vars,omitempty" yaml:"vars,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for PolicyTestConfig.
// It captures the YAML node position for FileMetadata.
func (v *PolicyTestConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainPolicyTestConfig PolicyTestConfig
	x := (*plainPolicyTestConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

type PolicyTestConfigDataStream struct {
	// Vars variables used to configure settings defined in the data stream manifest.
	Vars *TestVars `json:"vars,omitempty" yaml:"vars,omitempty"`
}

// StaticTestConfig holds configuration for a static test case (test-*-config.yml).
type StaticTestConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	Skip         TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for StaticTestConfig.
// It captures the YAML node position for FileMetadata.
func (v *StaticTestConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainStaticTestConfig StaticTestConfig
	x := (*plainStaticTestConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// SystemTestConfig holds configuration for a system test case (test-*-config.yml).
type SystemTestConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// Agent configuration overrides for the Elastic Agent
	Agent      SystemTestConfigAgent       `json:"agent,omitempty" yaml:"agent,omitempty"`
	DataStream *SystemTestConfigDataStream `json:"data_stream,omitempty" yaml:"data_stream,omitempty"`
	Skip       TestSkip                    `json:"skip,omitempty" yaml:"skip,omitempty"`
	// SkipIgnoredFields if listed here, elastic-package system tests will not fail if values for the
	// specified field names can't be indexed for any incoming documents. This should only be used if
	// the failure is related to the test environment and wouldn't happen in production. Mitigate the
	// issue via mapping or pipeline changes otherwise.
	SkipIgnoredFields []string `json:"skip_ignored_fields,omitempty" yaml:"skip_ignored_fields,omitempty"`
	// Vars variables used to configure settings defined in the package manifest.
	Vars TestVars `json:"vars,omitempty" yaml:"vars,omitempty"`
	// WaitForDataTimeout timeout for waiting for metrics data during a system test.
	WaitForDataTimeout string `json:"wait_for_data_timeout,omitempty" yaml:"wait_for_data_timeout,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for SystemTestConfig.
// It captures the YAML node position for FileMetadata.
func (v *SystemTestConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainSystemTestConfig SystemTestConfig
	x := (*plainSystemTestConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// SystemTestConfigAgent configuration overrides for the Elastic Agent
type SystemTestConfigAgent struct {
	// BaseImage elastic Agent image to be used for testing. Setting `default` will be used the same
	// Elastic Agent image as the stack. Setting `systemd` will use the image containing all the
	// binaries for running Beats (collectors) based in an OS compatible with systemd. Setting
	// `complete` will use the "complete" image, that includes all supported collectors plus a web
	// browser and the required runtime for synthetic testing.
	BaseImage SystemTestConfigAgentBaseImage `json:"base_image,omitempty" yaml:"base_image,omitempty"`
	// LinuxCapabilities linux Capabilities that must been enabled in the system to run the Elastic
	// Agent process
	LinuxCapabilities []SystemTestConfigAgentLinuxCapability `json:"linux_capabilities,omitempty" yaml:"linux_capabilities,omitempty"`
	// PidMode control access to PID namespaces. When set to `host`, the Elastic Agent will have access
	// to the PID namespace of the host.
	PidMode SystemTestConfigAgentPidMode `json:"pid_mode,omitempty" yaml:"pid_mode,omitempty"`
	// Ports list of ports to be exposed to access to the Elastic Agent
	Ports []string `json:"ports,omitempty" yaml:"ports,omitempty"`
	// PreStartScript optional: Custom sh script to be executed before starting the Elastic Agent
	// process (e.g. export environment variables)
	PreStartScript SystemTestConfigAgentPreStartScript `json:"pre_start_script,omitempty" yaml:"pre_start_script,omitempty"`
	// ProvisioningScript optional: Script to run to customize the system where Elastic Agent runs (e.g.
	// installing new libraries/dependencies)
	ProvisioningScript SystemTestConfigAgentProvisioningScript `json:"provisioning_script,omitempty" yaml:"provisioning_script,omitempty"`
	// Runtime to run the Elastic Agent process
	Runtime SystemTestConfigAgentRuntime `json:"runtime,omitempty" yaml:"runtime,omitempty"`
	// User that runs the Elastic Agent process
	User string `json:"user,omitempty" yaml:"user,omitempty"`
}

// SystemTestConfigAgentBaseImage elastic Agent image to be used for testing. Setting `default` will
// be used the same Elastic Agent image as the stack. Setting `systemd` will use the image
// containing all the binaries for running Beats (collectors) based in an OS compatible with
// systemd. Setting `complete` will use the "complete" image, that includes all supported collectors
// plus a web browser and the required runtime for synthetic testing.
type SystemTestConfigAgentBaseImage string

// Enum values for SystemTestConfigAgentBaseImage.
const (
	SystemTestConfigAgentBaseImageDefault  SystemTestConfigAgentBaseImage = "default"
	SystemTestConfigAgentBaseImageComplete SystemTestConfigAgentBaseImage = "complete"
	SystemTestConfigAgentBaseImageSystemd  SystemTestConfigAgentBaseImage = "systemd"
)

// SystemTestConfigAgentLinuxCapability capability name
type SystemTestConfigAgentLinuxCapability string

// Enum values for SystemTestConfigAgentLinuxCapability.
const (
	SystemTestConfigAgentLinuxCapabilityAuditControl      SystemTestConfigAgentLinuxCapability = "AUDIT_CONTROL"
	SystemTestConfigAgentLinuxCapabilityAuditRead         SystemTestConfigAgentLinuxCapability = "AUDIT_READ"
	SystemTestConfigAgentLinuxCapabilityAuditWrite        SystemTestConfigAgentLinuxCapability = "AUDIT_WRITE"
	SystemTestConfigAgentLinuxCapabilityBlockSuspend      SystemTestConfigAgentLinuxCapability = "BLOCK_SUSPEND"
	SystemTestConfigAgentLinuxCapabilityBpf               SystemTestConfigAgentLinuxCapability = "BPF"
	SystemTestConfigAgentLinuxCapabilityCheckpointRestore SystemTestConfigAgentLinuxCapability = "CHECKPOINT_RESTORE"
	SystemTestConfigAgentLinuxCapabilityChown             SystemTestConfigAgentLinuxCapability = "CHOWN"
	SystemTestConfigAgentLinuxCapabilityDacOverride       SystemTestConfigAgentLinuxCapability = "DAC_OVERRIDE"
	SystemTestConfigAgentLinuxCapabilityDacReadSearch     SystemTestConfigAgentLinuxCapability = "DAC_READ_SEARCH"
	SystemTestConfigAgentLinuxCapabilityFowner            SystemTestConfigAgentLinuxCapability = "FOWNER"
	SystemTestConfigAgentLinuxCapabilityFsetid            SystemTestConfigAgentLinuxCapability = "FSETID"
	SystemTestConfigAgentLinuxCapabilityIpcLock           SystemTestConfigAgentLinuxCapability = "IPC_LOCK"
	SystemTestConfigAgentLinuxCapabilityIpcOwner          SystemTestConfigAgentLinuxCapability = "IPC_OWNER"
	SystemTestConfigAgentLinuxCapabilityKill              SystemTestConfigAgentLinuxCapability = "KILL"
	SystemTestConfigAgentLinuxCapabilityLease             SystemTestConfigAgentLinuxCapability = "LEASE"
	SystemTestConfigAgentLinuxCapabilityLinuxImmutable    SystemTestConfigAgentLinuxCapability = "LINUX_IMMUTABLE"
	SystemTestConfigAgentLinuxCapabilityMacAdmin          SystemTestConfigAgentLinuxCapability = "MAC_ADMIN"
	SystemTestConfigAgentLinuxCapabilityMacOverride       SystemTestConfigAgentLinuxCapability = "MAC_OVERRIDE"
	SystemTestConfigAgentLinuxCapabilityMknod             SystemTestConfigAgentLinuxCapability = "MKNOD"
	SystemTestConfigAgentLinuxCapabilityNetAdmin          SystemTestConfigAgentLinuxCapability = "NET_ADMIN"
	SystemTestConfigAgentLinuxCapabilityNetBindService    SystemTestConfigAgentLinuxCapability = "NET_BIND_SERVICE"
	SystemTestConfigAgentLinuxCapabilityNetBroadcast      SystemTestConfigAgentLinuxCapability = "NET_BROADCAST"
	SystemTestConfigAgentLinuxCapabilityNetRaw            SystemTestConfigAgentLinuxCapability = "NET_RAW"
	SystemTestConfigAgentLinuxCapabilityPerform           SystemTestConfigAgentLinuxCapability = "PERFORM"
	SystemTestConfigAgentLinuxCapabilitySetfcap           SystemTestConfigAgentLinuxCapability = "SETFCAP"
	SystemTestConfigAgentLinuxCapabilitySetgid            SystemTestConfigAgentLinuxCapability = "SETGID"
	SystemTestConfigAgentLinuxCapabilitySetpcap           SystemTestConfigAgentLinuxCapability = "SETPCAP"
	SystemTestConfigAgentLinuxCapabilitySetuid            SystemTestConfigAgentLinuxCapability = "SETUID"
	SystemTestConfigAgentLinuxCapabilitySysAdmin          SystemTestConfigAgentLinuxCapability = "SYS_ADMIN"
	SystemTestConfigAgentLinuxCapabilitySysBoot           SystemTestConfigAgentLinuxCapability = "SYS_BOOT"
	SystemTestConfigAgentLinuxCapabilitySysChroot         SystemTestConfigAgentLinuxCapability = "SYS_CHROOT"
	SystemTestConfigAgentLinuxCapabilitySysModule         SystemTestConfigAgentLinuxCapability = "SYS_MODULE"
	SystemTestConfigAgentLinuxCapabilitySysNice           SystemTestConfigAgentLinuxCapability = "SYS_NICE"
	SystemTestConfigAgentLinuxCapabilitySysPacct          SystemTestConfigAgentLinuxCapability = "SYS_PACCT"
	SystemTestConfigAgentLinuxCapabilitySysPtrace         SystemTestConfigAgentLinuxCapability = "SYS_PTRACE"
	SystemTestConfigAgentLinuxCapabilitySysRawio          SystemTestConfigAgentLinuxCapability = "SYS_RAWIO"
	SystemTestConfigAgentLinuxCapabilitySysResource       SystemTestConfigAgentLinuxCapability = "SYS_RESOURCE"
	SystemTestConfigAgentLinuxCapabilitySysTime           SystemTestConfigAgentLinuxCapability = "SYS_TIME"
	SystemTestConfigAgentLinuxCapabilitySysTtyConfig      SystemTestConfigAgentLinuxCapability = "SYS_TTY_CONFIG"
	SystemTestConfigAgentLinuxCapabilitySyslog            SystemTestConfigAgentLinuxCapability = "SYSLOG"
	SystemTestConfigAgentLinuxCapabilityWakeAlarm         SystemTestConfigAgentLinuxCapability = "WAKE_ALARM"
)

// SystemTestConfigAgentPidMode control access to PID namespaces. When set to `host`, the Elastic
// Agent will have access to the PID namespace of the host.
type SystemTestConfigAgentPidMode string

// Enum values for SystemTestConfigAgentPidMode.
const (
	SystemTestConfigAgentPidModeHost SystemTestConfigAgentPidMode = "host"
)

// SystemTestConfigAgentPreStartScript optional: Custom sh script to be executed before starting the
// Elastic Agent process (e.g. export environment variables)
type SystemTestConfigAgentPreStartScript struct {
	// Contents code to run before starting the Elastic Agent.
	Contents string `json:"contents" yaml:"contents"`
	// Language programming language of the pre-start script. Currently, only "sh" is supported.
	Language SystemTestConfigAgentPreStartScriptLanguage `json:"language,omitempty" yaml:"language,omitempty"`
}

// SystemTestConfigAgentPreStartScriptLanguage programming language of the pre-start script.
// Currently, only "sh" is supported.
type SystemTestConfigAgentPreStartScriptLanguage string

// Enum values for SystemTestConfigAgentPreStartScriptLanguage.
const (
	SystemTestConfigAgentPreStartScriptLanguageSh SystemTestConfigAgentPreStartScriptLanguage = "sh"
)

// SystemTestConfigAgentProvisioningScript optional: Script to run to customize the system where
// Elastic Agent runs (e.g. installing new libraries/dependencies)
type SystemTestConfigAgentProvisioningScript struct {
	// Contents code to run as a provisioning script.
	Contents string `json:"contents" yaml:"contents"`
	// Language programming language of the provisioning script.
	Language string `json:"language,omitempty" yaml:"language,omitempty"`
}

// SystemTestConfigAgentRuntime runtime to run the Elastic Agent process
type SystemTestConfigAgentRuntime string

// Enum values for SystemTestConfigAgentRuntime.
const (
	SystemTestConfigAgentRuntimeDocker SystemTestConfigAgentRuntime = "docker"
)

type SystemTestConfigDataStream struct {
	// Vars variables used to configure settings defined in the data stream manifest.
	Vars TestVars `json:"vars,omitempty" yaml:"vars,omitempty"`
}

// TestCategoryConfig controls parallelism and skip for a test category.
type TestCategoryConfig struct {
	// Parallel tests defined can be run in parallel (default true).
	Parallel *bool    `json:"parallel,omitempty" yaml:"parallel,omitempty"`
	Skip     TestSkip `json:"skip,omitempty" yaml:"skip,omitempty"`
}

// TestConfig holds the package-level test configuration for integration packages
// (_dev/test/config.yml).
type TestConfig struct {
	FileMetadata `json:"-" yaml:"-"`
	// Asset configuration for asset tests
	Asset TestCategoryConfig `json:"asset,omitempty" yaml:"asset,omitempty"`
	// Pipeline configuration for pipeline tests
	Pipeline TestCategoryConfig `json:"pipeline,omitempty" yaml:"pipeline,omitempty"`
	// Policy configuration for policy tests
	Policy TestCategoryConfig `json:"policy,omitempty" yaml:"policy,omitempty"`
	// Static configuration for static tests
	Static TestCategoryConfig `json:"static,omitempty" yaml:"static,omitempty"`
	// System configuration for system tests
	System TestCategoryConfig `json:"system,omitempty" yaml:"system,omitempty"`
}

// UnmarshalYAML implements yaml.Unmarshaler for TestConfig.
// It captures the YAML node position for FileMetadata.
func (v *TestConfig) UnmarshalYAML(node *yamlv3.Node) error {
	type plainTestConfig TestConfig
	x := (*plainTestConfig)(v)
	if err := node.Decode(x); err != nil {
		return err
	}
	v.FileMetadata.line = node.Line
	v.FileMetadata.column = node.Column
	return nil
}

// TestSkip describes why a test should be skipped, with a reason and tracking link.
type TestSkip struct {
	// Link to issue with more details about skipped test or to track re-enabling skipped test.
	Link string `json:"link" yaml:"link"`
	// Reason short explanation for why test has been skipped.
	Reason string `json:"reason" yaml:"reason"`
}

// TestVars holds variables defined for a test case.
type TestVars struct {
	DataStreamDataset string `json:"data_stream.dataset,omitempty" yaml:"data_stream.dataset,omitempty"`
}
